<div class="admin-container" [class.blur-background]="showPopup">
  
  <!-- HEADER -->
  <header class="admin-header">
    <div class="header-content">
      <h1 class="admin-title">ADMINISTRADOR</h1>
      <div class="user-info">
        <span>Bem-vindo, {{ usuarioLogado?.nome || 'Admin' }}</span>
        <button class="btn-logout" (click)="voltarParaLogin()">Sair</button>
      </div>
    </div>
  </header>

  <!-- CONTE√öDO PRINCIPAL -->
  <main class="admin-main">
    
    <!-- BOT√ÉO DE CRIAR (CENTRALIZADO) -->
    <div class="create-section">
      <button class="btn-create" (click)="abrirPopupCriar()">
        <span class="icon">+</span> CRIAR NOVO USU√ÅRIO
      </button>
    </div>

 <!-- BOT√ïES ADICIONAIS -->
<div class="admin-actions">
  <button class="btn-action" (click)="gerarRelatorio()">
    üìä GERAR RELAT√ìRIO
  </button>
  <button class="btn-action" (click)="carregarUsuariosMock()">
    üîÑ RECARREGAR USU√ÅRIOS
  </button>
</div>

    <!-- LISTA DE USU√ÅRIOS -->
    <div class="users-section">
      <h2 class="section-title">USU√ÅRIOS CADASTRADOS</h2>
      
      <div class="users-grid">
        <div *ngFor="let usuario of usuarios" class="user-card" [class.aluno]="usuario.tipo === 'ALUNO'">
          
          <div class="user-header">
            <span class="user-type">{{ usuario.tipo }}</span>
            <div class="user-actions">
              <button class="btn-edit" (click)="editarUsuario(usuario)">‚úèÔ∏è</button>
              <button class="btn-delete" (click)="excluirUsuario(usuario)">üóëÔ∏è</button>
            </div>
          </div>
          
          <div class="user-info">
            <h3>{{ usuario.nome }}</h3>
            <p><strong>Email:</strong> {{ usuario.email }}</p>
            <p><strong>ID:</strong> #{{ usuario.id }}</p>
            
            <!-- INFO ESPEC√çFICA PARA ALUNOS -->
            <div *ngIf="usuario.tipo === 'ALUNO'" class="aluno-info">
              <p><strong>Peso:</strong> {{ usuario.peso || '--' }} kg</p>
              <p><strong>Altura:</strong> {{ usuario.altura || '--' }} m</p>
              <p><strong>Idade:</strong> {{ usuario.idade || '--' }} anos</p>
              <p *ngIf="usuario.imc"><strong>IMC:</strong> {{ usuario.imc }}</p>
            </div>
            
            <p class="user-date"><small>Criado em: {{ usuario.dataCriacao || '--' }}</small></p>
          </div>
          
        </div>
      </div>
      
      <div *ngIf="usuarios.length === 0" class="empty-state">
        <p>Nenhum usu√°rio cadastrado ainda.</p>
        <button class="btn-create" (click)="abrirPopupCriar()">Criar primeiro usu√°rio</button>
      </div>
    </div>

  </main>

  <!-- POP-UP DE CRIA√á√ÉO/EDI√á√ÉO -->
  <div *ngIf="showPopup" class="popup-overlay" (click)="fecharPopup()">
    <div class="popup-content" (click)="$event.stopPropagation()">
      
      <!-- CABE√áALHO DO POP-UP -->
      <div class="popup-header">
        <h2>{{ popupTitle }}</h2>
        <button class="btn-close" (click)="fecharPopup()">√ó</button>
      </div>

      <!-- FORMUL√ÅRIO NO POP-UP -->
      <form [formGroup]="userForm" (ngSubmit)="onSubmitForm()" class="popup-form">
        
        <!-- CAMPO NOME -->
        <div class="form-group">
          <label for="nome">Nome *</label>
          <input 
            type="text" 
            id="nome" 
            formControlName="nome" 
            placeholder="Digite o nome completo"
            [class.invalid]="userForm.get('nome')?.invalid && userForm.get('nome')?.touched"
          />
          <div *ngIf="userForm.get('nome')?.invalid && userForm.get('nome')?.touched" class="error-message">
            Nome √© obrigat√≥rio (m√≠nimo 3 caracteres)
          </div>
        </div>

        <!-- CAMPO EMAIL -->
        <div class="form-group">
          <label for="email">Email *</label>
          <input 
            type="email" 
            id="email" 
            formControlName="email" 
            placeholder="exemplo@email.com"
            [class.invalid]="userForm.get('email')?.invalid && userForm.get('email')?.touched"
          />
          <div *ngIf="userForm.get('email')?.invalid && userForm.get('email')?.touched" class="error-message">
            Digite um email v√°lido
          </div>
        </div>

        <!-- CAMPO TIPO -->
        <div class="form-group">
          <label for="tipo">Tipo de Usu√°rio *</label>
          <select id="tipo" formControlName="tipo" class="tipo-select">
            <option *ngFor="let tipo of tiposUsuario" [value]="tipo">{{ tipo }}</option>
          </select>
        </div>

        <!-- CAMPOS ESPEC√çFICOS PARA ALUNOS -->
        <div *ngIf="isAluno" class="aluno-fields">
          <h3>Informa√ß√µes do Aluno</h3>
          
          <div class="fields-grid">
            <!-- PESO -->
            <div class="form-group">
              <label for="peso">Peso (kg)</label>
              <input 
                type="number" 
                id="peso" 
                formControlName="peso" 
                placeholder="Ex: 70"
                min="0"
                step="0.1"
              />
            </div>

            <!-- ALTURA -->
            <div class="form-group">
              <label for="altura">Altura (m)</label>
              <input 
                type="number" 
                id="altura" 
                formControlName="altura" 
                placeholder="Ex: 1.75"
                min="0"
                step="0.01"
              />
            </div>

            <!-- IDADE -->
            <div class="form-group">
              <label for="idade">Idade</label>
              <input 
                type="number" 
                id="idade" 
                formControlName="idade" 
                placeholder="Ex: 25"
                min="0"
                max="120"
              />
            </div>
          </div>

          <!-- CALCULADORA DE IMC (visual) -->
          <div *ngIf="userForm.get('peso')?.value && userForm.get('altura')?.value" class="imc-calculator">
            <p><strong>IMC Calculado:</strong> 
              {{ (userForm.get('peso')?.value / (userForm.get('altura')?.value * userForm.get('altura')?.value)).toFixed(2) }}
            </p>
          </div>
        </div>

        <!-- BOT√ïES DO FORMUL√ÅRIO -->
        <div class="form-actions">
          <button type="button" class="btn-cancel" (click)="fecharPopup()">Cancelar</button>
          <button type="submit" class="btn-submit" [disabled]="userForm.invalid">
            {{ popupTitle.includes('Editar') ? 'ATUALIZAR' : 'CRIAR USU√ÅRIO' }}
          </button>
        </div>

      </form>
    </div>
  </div>

</div>